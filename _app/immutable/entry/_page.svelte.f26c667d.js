import{S as He,i as Je,s as We,k as E,q as w,a as A,l as N,m as b,r as P,c as B,h as g,n as s,b as re,G as h,u as ae,H as ye,J as $,K as Ke,e as $e,L as Oe,M as x,N as ee,p as se,O as _e,y as ht,z as ft,A as mt,g as dt,d as _t,B as gt}from"../chunks/index.0927561f.js";import{w as Kt}from"../chunks/index.6d3ad0ca.js";const M=(e,t)=>{const l=e%t;return l<0?l+t:l},Qt=e=>{if(isNaN(e))return"NaN";const t=String(+e).split("")??[],l=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let n="",o=3;for(;o--;)n=(l[+(t.pop()??"")+o*10]||"")+n;return Array(+t.join("")+1).join("M")+n},V=(e,t,l)=>{let n=0;for(let o=e;o<t;o++)n+=l[M(o,l.length)];return n},d=[{sharpNote:"C",flatNote:"C",defaultOctaveFrequency:261.63},{sharpNote:"C#",flatNote:"D♭",preferSharp:!0,defaultOctaveFrequency:277.18},{sharpNote:"D",flatNote:"D",defaultOctaveFrequency:293.66},{sharpNote:"D#",flatNote:"E♭",preferSharp:!1,defaultOctaveFrequency:311.13},{sharpNote:"E",flatNote:"E",defaultOctaveFrequency:329.63},{sharpNote:"F",flatNote:"F",defaultOctaveFrequency:349.23},{sharpNote:"F#",flatNote:"G♭",preferSharp:!0,defaultOctaveFrequency:185},{sharpNote:"G",flatNote:"G",defaultOctaveFrequency:196},{sharpNote:"G#",flatNote:"A♭",preferSharp:!1,defaultOctaveFrequency:207.65},{sharpNote:"A",flatNote:"A",defaultOctaveFrequency:220},{sharpNote:"A#",flatNote:"B♭",preferSharp:!1,defaultOctaveFrequency:233.08},{sharpNote:"A",flatNote:"B",defaultOctaveFrequency:246.94}],X=[2,2,1,2,2,2,1],ie=[2,2,3,2,3],ge=[3,2,1,1,3,2],je=[1,256/243,9/8,32/27,81/64,4/3,1024/729,3/2,128/81,27/16,16/9,243/128],vt={pentatonic:[.3,.05,.05,.2,.1],diatonic:[.3,.05,.15,.05,.075,.05,.03],hexatonic:[.3,.075,.15,.075,.075,.05]},pt={pentatonic:[.5,.05,.15,.2,.05],diatonic:[.5,.02,.05,.1,.1,.05,.02],hexatonic:[.5,.02,.05,.1,.1,.05]},Re=.25,Wt=(e,t)=>e===4&&t===7?"major":e===3&&t===7?"minor":e===3&&t===6?"diminished":"bizarre",Dt=(e,t)=>{const l=[{...t[e]},{...t[M(e+2,t.length)]},{...t[M(e+4,t.length)]}];return Wt(l[1].semitonesFromRoot,l[1].semitonesFromRoot+l[2].semitonesFromRoot)},Yt=e=>Wt(e.firstInterval.semitonesFromRoot,e.secondInterval.semitonesFromRoot),Zt=(e,t)=>({firstInterval:{semitonesFromRoot:V(e,e+2,t)},secondInterval:{semitonesFromRoot:V(e,e+4,t)}}),xt=(e,t,l)=>{const n=Qt(M(e+1,l.length+1)),o=e+t,a=Yt(Zt(o,l));return a==="major"?n:a==="minor"?n.toLowerCase():a==="diminished"?`${n.toLowerCase()}°`:n},q=(e,t)=>{const l=[];for(let n=0;n<t.length;n++)l.push({semitonesFromRoot:V(e,e+n,t),label:xt(n,e,t)});return l},Rt=(e,t)=>{const l=t+1;if(e===1)return`A${l}`;if([1,4,5].includes(l)){if(e===0)return`P${l}`;if(e===-1)return`d${l}`}if(e===0)return`M${l}`;if(e===-1)return`m${l}`;if(e===-2)return`d${l}`},Xe=(e,t)=>{const l=e.semitonesFromRoot-V(0,t,X),n=Rt(l,t);if(n)return n;let o=0;for(;o<X.length;){const a=e.semitonesFromRoot-V(0,o,X),r=Rt(a,o);if(r)return r;o++}return`${e.semitonesFromRoot}s`},en=q(0,X),tn=q(1,X),nn=q(2,X),ln=q(3,X),on=q(4,X),an=q(5,X),rn=q(6,X),sn=[{name:"Ionian / Major",scale:en,rootIntervalToIonian:V(0,0,X)},{name:"Dorian",scale:tn,rootIntervalToIonian:V(0,1,X)},{name:"Phrygian",scale:nn,rootIntervalToIonian:V(0,2,X)},{name:"Lydian",scale:ln,rootIntervalToIonian:V(0,3,X)},{name:"Mixolydian",scale:on,rootIntervalToIonian:V(0,4,X)},{name:"Aeolian / Natural Minor",scale:an,rootIntervalToIonian:V(0,5,X)},{name:"Locrian",scale:rn,rootIntervalToIonian:V(0,6,X)}],cn=q(0,ie),un=q(1,ie),hn=q(2,ie),fn=q(3,ie),mn=q(4,ie),dn=[{name:"Major",scale:cn,rootIntervalToIonian:V(0,0,ie)},{name:"Suspended / Egyptian",scale:un,rootIntervalToIonian:V(0,1,ie)},{name:"Blues minor / Man Gong",scale:hn,rootIntervalToIonian:V(0,2,ie)},{name:"Blues major",scale:fn,rootIntervalToIonian:V(0,3,ie)},{name:"Minor",scale:mn,rootIntervalToIonian:V(0,4,ie)}],_n=q(0,ge),gn=q(1,ge);q(2,ge);q(3,ge);q(4,ge);q(5,ge);const vn=[{name:"Minor",scale:_n,rootIntervalToIonian:V(0,0,ge)},{name:"Major",scale:gn,rootIntervalToIonian:V(0,1,ge)}],bt=[{label:"Diatonic",modes:sn,probabilityDistributions:{bass:pt.diatonic,melody:vt.diatonic}},{label:"Pentatonic",modes:dn,probabilityDistributions:{bass:pt.pentatonic,melody:vt.pentatonic}},{label:"Hexatonic (blues)",modes:vn,probabilityDistributions:{bass:pt.hexatonic,melody:vt.hexatonic}}],yt=Kt({}),Ae=300,Ge=.75,pn=12,bn=1e-6,yn={attackTime:.1,decayTime:.3,releaseTime:.5,maxSustainTime:.2,maxGain:.1,sustainGainRatio:.1,oscillatorType:"sine"},kn=(e,t)=>{let l=1;for(;t<0;)t=t+je.length,l=l*.5;for(;t>=je.length;)t=t-je.length,l=l*2;return l=l*je[t],e.defaultOctaveFrequency*l},z=(e,t,l,n,o={})=>{if(n<l){console.log("Warning: note end time earlier than start time");return}const a={...yn,...o};let{attackTime:r,decayTime:i}={...a};const{releaseTime:u,maxSustainTime:c,maxGain:m,sustainGainRatio:_,oscillatorType:I="triangle"}={...a},y=m*_,p=new AudioContext,k=p.createOscillator(),T=p.createGain(),U=p.createDynamicsCompressor();T.gain.value=.001,k.type=I,k.frequency.value=kn(e,t),k.connect(T).connect(U).connect(p.destination);const O=n-l;r>O/(2*1e3)&&(r=O/(2*1e3)),i+r>O/1e3&&(i=O/1e3-r);let S=c??1e4;S>O/1e3-r-i&&(S=O/1e3-r-i),setTimeout(function(){const C=p.currentTime+r;T.gain.exponentialRampToValueAtTime(m,C),yt.update(j=>({...j,[M(t,d.length)]:(j[`${M(t,d.length)}`]??0)+1})),k.start(),setTimeout(()=>{T.gain.exponentialRampToValueAtTime(y,p.currentTime+i),setTimeout(()=>{T.gain.exponentialRampToValueAtTime(bn,p.currentTime+u),yt.update(j=>{const te=Math.max((j[`${M(t,d.length)}`]??0)-1,0);return console.log("removing",M(t,d.length),"from",j,"to give",te),{...j,[M(t,d.length)]:te}}),setTimeout(function(){k.stop(),p.close()},u*1e3+2e3)},S*1e3)},r*1e3)},l)},At=(e,t,l,n=Ae,o=Ge)=>{const a=n*.5*o,r=n*.5-a,i=n*.5,u=[{...l[t]},{...l[M(t+2,l.length)]},{...l[M(t+4,l.length)]}];u.forEach((c,m)=>{m<=0||(console.log(c.semitonesFromRoot<u[m-1].semitonesFromRoot,c.semitonesFromRoot,u[m-1].semitonesFromRoot),c.semitonesFromRoot<u[m-1].semitonesFromRoot&&(c.semitonesFromRoot+=d.length))}),console.log("mapped scale notes",u),[...u].forEach((c,m)=>{z(d[e],c.semitonesFromRoot,m*i+r,m*i+r+a+i)}),[...u].forEach(c=>{z(d[e],c.semitonesFromRoot,(u.length+1)*i+r,(u.length+1)*i+r+(a+i)*2)})},Bt=(e,t,l=Ae,n=Ge)=>{const o=l*.5*n,a=l*.5-o,r=l*.5;[...[{semitonesFromRoot:0},e]].forEach((u,c)=>{z(d[t],u.semitonesFromRoot,c*r+a,c*r+a+o+r)})},In=(e,t,l=Ae,n=Ge)=>{const o=l*.5*n,a=l*.5-o,r=l*.5;[...e].forEach((i,u)=>{u===0?z(d[t],i.semitonesFromRoot,u*2*r+a,u*2*r+a+o+r):(z(d[t],0,u*2*r+a,u*2*r+a+o),z(d[t],i.semitonesFromRoot,(u*2+1)*r+a,(u*2+1)*r+a+o))}),z(d[t],0,e.length*2*r+a,e.length*2*r+a+o),z(d[t],d.length,(e.length*2+1)*r+a,(e.length*2+1)*r+a+o)},Tn=(e,t,l=Ae,n=Ge)=>{const o=l*.5*n,a=l*.5-o,r=l*.5;z(d[t],e[0].semitonesFromRoot,a,r+a+o+r),[...e].forEach((i,u)=>{z(d[t],i.semitonesFromRoot,(u+2)*r+a,(u+2)*r+a+o+r)}),z(d[t],d.length,(e.length+2)*r+a,(e.length+2)*r+a+o),[...e].reverse().forEach((i,u)=>{z(d[t],i.semitonesFromRoot,(u+e.length+3)*r+a,(u+e.length+3)*r+a+o+r)})},En=(e,t,l=Ae,n=Ge)=>{const o=l*.5*n,a=l*.5-o,r=l*.5;z(d[t],0,a,a+r*(e.length*2+3),{maxSustainTime:r*(e.length*2+2),oscillatorType:"sine",sustainGainRatio:.5,maxGain:.0125}),[...e].forEach((i,u)=>{z(d[t],i.semitonesFromRoot,(u+2)*r+a,(u+2)*r+a+o+r)}),z(d[t],d.length,(e.length+2)*r+a,(e.length+2)*r+a+o),[...e].reverse().forEach((i,u)=>{z(d[t],i.semitonesFromRoot,(u+e.length+3)*r+a,(u+e.length+3)*r+a+o+r)})},Nn=(e,t,l,n,o=Ae,a=pn)=>{let r=0;for(;r<=a;)e.forEach((u,c)=>{if(!(c>=l.length)&&Math.random()<l[c]){const m=Math.random();let _=1;m>.8&&(_=2),m>.9&&(_=4),m>.95&&(_=6),m>.97&&(_=3),m>.99&&(_=8),z(d[t],u.semitonesFromRoot+d.length,o*r,o*r+o*Re*_),r+=Re}}),r+=Re;let i=0;for(;i<=a;)e.forEach((u,c)=>{if(!(c>=n.length)&&Math.random()<n[c]){const m=Math.random();let _=1;m>.8&&(_=2),m>.9&&(_=4),m>.95&&(_=6),m>.97&&(_=3),m>.99&&(_=8),z(d[t],u.semitonesFromRoot,o*i,o*i+o*2*Re*_),i+=2*Re}}),i+=2*Re},ce=e=>e.preferSharp?e.sharpNote:e.flatNote,Ot=(e,t,l)=>{let n=M(e-t,d.length);return n<0&&(n=n+d.length),l.some(o=>o.semitonesFromRoot===n)};function Mn(e){let t,l=ce(d[M(e[0],d.length)])+"",n,o,a;return{c(){t=E("h1"),n=w(l),o=A(),a=w(e[1]),this.h()},l(r){t=N(r,"H1",{class:!0});var i=b(t);n=P(i,l),o=B(i),a=P(i,e[1]),i.forEach(g),this.h()},h(){s(t,"class","svelte-10dbiud")},m(r,i){re(r,t,i),h(t,n),h(t,o),h(t,a)},p(r,[i]){i&1&&l!==(l=ce(d[M(r[0],d.length)])+"")&&ae(n,l),i&2&&ae(a,r[1])},i:ye,o:ye,d(r){r&&g(t)}}}function Sn(e,t,l){let{rootNoteIndex:n}=t,{selectedScaleName:o}=t;return e.$$set=a=>{"rootNoteIndex"in a&&l(0,n=a.rootNoteIndex),"selectedScaleName"in a&&l(1,o=a.selectedScaleName)},[n,o]}class Cn extends He{constructor(t){super(),Je(this,t,Sn,Mn,We,{rootNoteIndex:0,selectedScaleName:1})}}function Fn(e){let t,l,n,o,a,r,i,u,c,m,_,I,y,p;return{c(){t=E("div"),l=E("button"),n=w("▶ Scale"),o=A(),a=E("button"),r=w("▶ Scale + Pedal"),i=A(),u=E("button"),c=w("▶ Scale + Drone"),m=A(),_=E("button"),I=w("▶ Jam")},l(k){t=N(k,"DIV",{});var T=b(t);l=N(T,"BUTTON",{});var U=b(l);n=P(U,"▶ Scale"),U.forEach(g),o=B(T),a=N(T,"BUTTON",{});var O=b(a);r=P(O,"▶ Scale + Pedal"),O.forEach(g),i=B(T),u=N(T,"BUTTON",{});var S=b(u);c=P(S,"▶ Scale + Drone"),S.forEach(g),m=B(T),_=N(T,"BUTTON",{});var C=b(_);I=P(C,"▶ Jam"),C.forEach(g),T.forEach(g)},m(k,T){re(k,t,T),h(t,l),h(l,n),h(t,o),h(t,a),h(a,r),h(t,i),h(t,u),h(u,c),h(t,m),h(t,_),h(_,I),y||(p=[$(l,"click",e[4]),$(a,"click",e[5]),$(u,"click",e[6]),$(_,"click",e[7])],y=!0)},p:ye,i:ye,o:ye,d(k){k&&g(t),y=!1,Ke(p)}}}function wn(e,t,l){let{rootNoteIndex:n}=t,{bpm:o}=t,{selectedScaleNotes:a}=t,{selectedModesGroup:r}=t;const i=()=>{Tn(a,n,60*1e3/o)},u=()=>{In(a,n,60*1e3/o)},c=()=>{En(a,n,60*1e3/o)},m=()=>{Nn(a,n,r.probabilityDistributions.melody,r.probabilityDistributions.bass,60*1e3/o)};return e.$$set=_=>{"rootNoteIndex"in _&&l(0,n=_.rootNoteIndex),"bpm"in _&&l(1,o=_.bpm),"selectedScaleNotes"in _&&l(2,a=_.selectedScaleNotes),"selectedModesGroup"in _&&l(3,r=_.selectedModesGroup)},[n,o,a,r,i,u,c,m]}class Pn extends He{constructor(t){super(),Je(this,t,wn,Fn,We,{rootNoteIndex:0,bpm:1,selectedScaleNotes:2,selectedModesGroup:3})}}const Gt=(e,t,l)=>({x:l.xCentre+l.radius*Math.cos((e.semitonesFromRoot+t)*2*Math.PI/d.length-.5*Math.PI),y:l.yCentre+l.radius*Math.sin((e.semitonesFromRoot+t)*2*Math.PI/d.length-.5*Math.PI)}),kt=(e,t)=>({x:t.xCentre+t.radius*Math.cos(e*2*Math.PI/d.length-.5*Math.PI),y:t.yCentre+t.radius*Math.sin(e*2*Math.PI/d.length-.5*Math.PI)});function Lt(e,t,l){const n=e.slice();n[6]=t[l],n[9]=l;const o=kt(n[9],n[0]);return n[7]=o,n}function zt(e){let t,l,n,o,a,r,i,u,c,m=ce(e[6])+"",_,I,y,p,k,T;function U(){return e[4](e[9])}function O(...S){return e[5](e[9],...S)}return{c(){t=x("g"),l=x("circle"),a=x("circle"),c=x("text"),_=w(m),this.h()},l(S){t=ee(S,"g",{class:!0,tabindex:!0,"aria-label":!0,role:!0});var C=b(t);l=ee(C,"circle",{style:!0,cx:!0,cy:!0,r:!0,transform:!0,stroke:!0,fill:!0}),b(l).forEach(g),a=ee(C,"circle",{style:!0,cx:!0,cy:!0,r:!0,transform:!0,stroke:!0,fill:!0,opacity:!0,class:!0}),b(a).forEach(g),c=ee(C,"text",{x:!0,y:!0,class:!0,"text-anchor":!0,dy:!0});var j=b(c);_=P(j,m),j.forEach(g),C.forEach(g),this.h()},h(){se(l,"stroke-width","1.6871"),se(l,"stroke-miterlimit","10"),s(l,"cx",0),s(l,"cy",0),s(l,"r",30),s(l,"transform",n=`translate(${e[7].x} ${e[7].y})`),s(l,"stroke","transparent"),s(l,"fill",o=e[9]===e[1]?"yellow":"var(--base-background-color)"),se(a,"stroke-width","1.6871"),se(a,"stroke-miterlimit","10"),s(a,"cx",0),s(a,"cy",0),s(a,"r",30),s(a,"transform",r=`translate(${e[7].x} ${e[7].y})`),s(a,"stroke","transparent"),s(a,"fill",i=e[3][`${M(e[9]-e[1],d.length)}`]>0?"blue":"var(--base-background-color)"),s(a,"opacity",u=(e[3][`${M(e[9]-e[1],d.length)}`]??0)/3),s(a,"class","transitionAllQuick svelte-bfkdcb"),s(c,"x",I=e[7].x),s(c,"y",y=e[7].y),s(c,"class",p=_e(`svgNoteName ${Ot(e[9],e[1],e[2])?"svgSelectedNoteName":""}`)+" svelte-bfkdcb"),s(c,"text-anchor","middle"),s(c,"dy",".3em"),s(t,"class","clickable"),s(t,"tabindex","0"),s(t,"aria-label",`Play ${ce(e[6])}`),s(t,"role","button")},m(S,C){re(S,t,C),h(t,l),h(t,a),h(t,c),h(c,_),k||(T=[$(t,"click",U),$(t,"keydown",O)],k=!0)},p(S,C){e=S,C&1&&n!==(n=`translate(${e[7].x} ${e[7].y})`)&&s(l,"transform",n),C&2&&o!==(o=e[9]===e[1]?"yellow":"var(--base-background-color)")&&s(l,"fill",o),C&1&&r!==(r=`translate(${e[7].x} ${e[7].y})`)&&s(a,"transform",r),C&10&&i!==(i=e[3][`${M(e[9]-e[1],d.length)}`]>0?"blue":"var(--base-background-color)")&&s(a,"fill",i),C&10&&u!==(u=(e[3][`${M(e[9]-e[1],d.length)}`]??0)/3)&&s(a,"opacity",u),C&1&&I!==(I=e[7].x)&&s(c,"x",I),C&1&&y!==(y=e[7].y)&&s(c,"y",y),C&6&&p!==(p=_e(`svgNoteName ${Ot(e[9],e[1],e[2])?"svgSelectedNoteName":""}`)+" svelte-bfkdcb")&&s(c,"class",p)},d(S){S&&g(t),k=!1,Ke(T)}}}function Dn(e){let t,l=[...d],n=[];for(let o=0;o<l.length;o+=1)n[o]=zt(Lt(e,l,o));return{c(){for(let o=0;o<n.length;o+=1)n[o].c();t=$e()},l(o){for(let a=0;a<n.length;a+=1)n[a].l(o);t=$e()},m(o,a){for(let r=0;r<n.length;r+=1)n[r].m(o,a);re(o,t,a)},p(o,[a]){if(a&15){l=[...d];let r;for(r=0;r<l.length;r+=1){const i=Lt(o,l,r);n[r]?n[r].p(i,a):(n[r]=zt(i),n[r].c(),n[r].m(t.parentNode,t))}for(;r<n.length;r+=1)n[r].d(1);n.length=l.length}},i:ye,o:ye,d(o){Oe(n,o),o&&g(t)}}}function Rn(e,t,l){let{notePositionCircle:n}=t,{rootNoteIndex:o}=t,{selectedScaleNotes:a}=t,r={};yt.subscribe(c=>{l(3,r=c)});const i=c=>z(d[o],M(c-o,d.length),0,500),u=(c,m)=>m.key==="Enter"&&z(d[o],M(c-o,d.length),0,500);return e.$$set=c=>{"notePositionCircle"in c&&l(0,n=c.notePositionCircle),"rootNoteIndex"in c&&l(1,o=c.rootNoteIndex),"selectedScaleNotes"in c&&l(2,a=c.selectedScaleNotes)},[n,o,a,r,i,u]}class An extends He{constructor(t){super(),Je(this,t,Rn,Dn,We,{notePositionCircle:0,rootNoteIndex:1,selectedScaleNotes:2})}}function Vt(e,t,l){const n=e.slice();n[20]=t[l];const o=n[1];return n[21]=o,n}function qt(e,t,l){const n=e.slice();n[20]=t[l];const o=n[1]+n[20].rootIntervalToIonian-n[3].rootIntervalToIonian;return n[21]=o,n}function Ut(e,t,l){const n=e.slice();return n[26]=t[l],n}function jt(e,t,l){const n=e.slice();n[29]=t[l],n[34]=l;const o=n[0]?kt(n[3].scale[M(n[34]-n[2].modes.findIndex(i=>i===n[3]),n[3].scale.length)].semitonesFromRoot+n[1],n[6]):kt(n[29].semitonesFromRoot+n[1],n[6]);n[30]=o;const a=Gt(n[29],n[1],n[7]);n[31]=a;const r=Gt(n[29],n[1],n[8]);return n[32]=r,n}function Xt(e){let t,l,n,o,a,r,i,u=e[29].label+"",c,m,_,I,y,p,k,T=Xe(e[29],e[34])+"",U,O,S,C,j;function te(){return e[9](e[34])}function G(...L){return e[10](e[34],...L)}function ne(){return e[11](e[29])}function ue(...L){return e[12](e[29],...L)}return{c(){t=x("circle"),n=x("g"),o=x("g"),a=x("circle"),i=x("text"),c=w(u),I=x("g"),y=x("circle"),k=x("text"),U=w(T),this.h()},l(L){t=ee(L,"circle",{style:!0,cx:!0,cy:!0,r:!0,transform:!0,stroke:!0,fill:!0,class:!0}),b(t).forEach(g),n=ee(L,"g",{class:!0});var D=b(n);o=ee(D,"g",{class:!0,tabindex:!0,"aria-label":!0,role:!0});var oe=b(o);a=ee(oe,"circle",{style:!0,cx:!0,cy:!0,r:!0,transform:!0,stroke:!0,fill:!0}),b(a).forEach(g),i=ee(oe,"text",{x:!0,y:!0,"text-anchor":!0,dy:!0,transform:!0,class:!0});var ke=b(i);c=P(ke,u),ke.forEach(g),oe.forEach(g),I=ee(D,"g",{class:!0,tabindex:!0,"aria-label":!0,role:!0});var he=b(I);y=ee(he,"circle",{style:!0,cx:!0,cy:!0,r:!0,transform:!0,stroke:!0,fill:!0}),b(y).forEach(g),k=ee(he,"text",{x:!0,y:!0,"text-anchor":!0,dy:!0,transform:!0,class:!0});var ve=b(k);U=P(ve,T),ve.forEach(g),he.forEach(g),D.forEach(g),this.h()},h(){se(t,"stroke-width","1.6871"),se(t,"stroke-miterlimit","10"),s(t,"cx",0),s(t,"cy",0),s(t,"r",30),s(t,"transform",l=`translate(${e[30].x} ${e[30].y})`),s(t,"stroke","black"),s(t,"fill","transparent"),s(t,"class","transitionAll svelte-xzpph0"),se(a,"stroke-width","1.6871"),se(a,"stroke-miterlimit","10"),s(a,"cx",0),s(a,"cy",0),s(a,"r",30),s(a,"transform",r=`translate(${e[31].x} ${e[31].y})`),s(a,"stroke","transparent"),s(a,"fill","transparent"),s(i,"x",0),s(i,"y",0),s(i,"text-anchor","middle"),s(i,"dy",".3em"),s(i,"transform",m=`translate(${e[31].x} ${e[31].y})`),s(i,"class","svgNoteName scaleNote transitionAll svelte-xzpph0"),s(o,"class","clickable"),s(o,"tabindex","0"),s(o,"aria-label",_=`Play ${d[M(e[1]+e[29].semitonesFromRoot,d.length)]} ${Dt(e[34],e[3].scale)} triad`),s(o,"role","button"),se(y,"stroke-width","1.6871"),se(y,"stroke-miterlimit","10"),s(y,"cx",0),s(y,"cy",0),s(y,"r",30),s(y,"transform",p=`translate(${e[32].x} ${e[32].y})`),s(y,"stroke","transparent"),s(y,"fill","transparent"),s(k,"x",0),s(k,"y",0),s(k,"text-anchor","middle"),s(k,"dy",".3em"),s(k,"transform",O=`translate(${e[32].x} ${e[32].y})`),s(k,"class","svgNoteName scaleNote transitionAll svelte-xzpph0"),s(I,"class","clickable"),s(I,"tabindex","0"),s(I,"aria-label",S=`Play ${Xe(e[29],e[34])} interval`),s(I,"role","button"),s(n,"class","transitionNote")},m(L,D){re(L,t,D),re(L,n,D),h(n,o),h(o,a),h(o,i),h(i,c),h(n,I),h(I,y),h(I,k),h(k,U),C||(j=[$(o,"click",te),$(o,"keydown",G),$(I,"click",ne),$(I,"keydown",ue)],C=!0)},p(L,D){e=L,D[0]&15&&l!==(l=`translate(${e[30].x} ${e[30].y})`)&&s(t,"transform",l),D[0]&10&&r!==(r=`translate(${e[31].x} ${e[31].y})`)&&s(a,"transform",r),D[0]&8&&u!==(u=e[29].label+"")&&ae(c,u),D[0]&10&&m!==(m=`translate(${e[31].x} ${e[31].y})`)&&s(i,"transform",m),D[0]&10&&_!==(_=`Play ${d[M(e[1]+e[29].semitonesFromRoot,d.length)]} ${Dt(e[34],e[3].scale)} triad`)&&s(o,"aria-label",_),D[0]&10&&p!==(p=`translate(${e[32].x} ${e[32].y})`)&&s(y,"transform",p),D[0]&8&&T!==(T=Xe(e[29],e[34])+"")&&ae(U,T),D[0]&10&&O!==(O=`translate(${e[32].x} ${e[32].y})`)&&s(k,"transform",O),D[0]&8&&S!==(S=`Play ${Xe(e[29],e[34])} interval`)&&s(I,"aria-label",S)},d(L){L&&g(t),L&&g(n),C=!1,Ke(j)}}}function $t(e){let t,l=e[26].label+"",n,o,a,r,i;function u(){return e[15](e[26])}return{c(){t=E("button"),n=w(l),o=A(),this.h()},l(c){t=N(c,"BUTTON",{class:!0});var m=b(t);n=P(m,l),o=B(m),m.forEach(g),this.h()},h(){s(t,"class",a=_e(e[2]===e[26]?"selectedTab":"")+" svelte-xzpph0")},m(c,m){re(c,t,m),h(t,n),h(t,o),r||(i=$(t,"click",u),r=!0)},p(c,m){e=c,m[0]&4&&a!==(a=_e(e[2]===e[26]?"selectedTab":"")+" svelte-xzpph0")&&s(t,"class",a)},d(c){c&&g(t),r=!1,i()}}}function Ht(e){let t,l,n=ce(d[M(e[21],d.length)])+"",o,a,r=e[20].name+"",i,u,c,m,_;function I(){return e[16](e[20],e[21])}return{c(){t=E("button"),l=E("span"),o=w(n),a=A(),i=w(r),u=A(),this.h()},l(y){t=N(y,"BUTTON",{class:!0});var p=b(t);l=N(p,"SPAN",{class:!0});var k=b(l);o=P(k,n),k.forEach(g),a=B(p),i=P(p,r),u=B(p),p.forEach(g),this.h()},h(){s(l,"class","noteLabel svelte-xzpph0"),s(t,"class",c=_e(e[20]===e[3]&&e[0]?"selectedTab":"")+" svelte-xzpph0")},m(y,p){re(y,t,p),h(t,l),h(l,o),h(t,a),h(t,i),h(t,u),m||(_=$(t,"click",I),m=!0)},p(y,p){e=y,p[0]&14&&n!==(n=ce(d[M(e[21],d.length)])+"")&&ae(o,n),p[0]&4&&r!==(r=e[20].name+"")&&ae(i,r),p[0]&13&&c!==(c=_e(e[20]===e[3]&&e[0]?"selectedTab":"")+" svelte-xzpph0")&&s(t,"class",c)},d(y){y&&g(t),m=!1,_()}}}function Jt(e){let t,l,n=ce(d[M(e[21],d.length)])+"",o,a,r=e[20].name+"",i,u,c,m,_;function I(){return e[17](e[20],e[21])}return{c(){t=E("button"),l=E("span"),o=w(n),a=A(),i=w(r),u=A(),this.h()},l(y){t=N(y,"BUTTON",{class:!0});var p=b(t);l=N(p,"SPAN",{class:!0});var k=b(l);o=P(k,n),k.forEach(g),a=B(p),i=P(p,r),u=B(p),p.forEach(g),this.h()},h(){s(l,"class","noteLabel svelte-xzpph0"),s(t,"class",c=_e(e[20]===e[3]&&!e[0]?"selectedTab":"")+" svelte-xzpph0")},m(y,p){re(y,t,p),h(t,l),h(l,o),h(t,a),h(t,i),h(t,u),m||(_=$(t,"click",I),m=!0)},p(y,p){e=y,p[0]&2&&n!==(n=ce(d[M(e[21],d.length)])+"")&&ae(o,n),p[0]&4&&r!==(r=e[20].name+"")&&ae(i,r),p[0]&13&&c!==(c=_e(e[20]===e[3]&&!e[0]?"selectedTab":"")+" svelte-xzpph0")&&s(t,"class",c)},d(y){y&&g(t),m=!1,_()}}}function Bn(e){let t,l,n,o,a,r,i,u,c,m,_,I,y,p,k,T=ce(d[M(e[1],d.length)])+"",U,O,S,C,j,te,G,ne,ue,L,D,oe,ke,he=e[2].label+"",ve,Qe,Ye,Ze,Be,me,Ie,xe,et,tt,Te,de,nt,Ee,Ne,fe,Me,lt,ot,pe,Le,at,rt,Se,st,be,it,It;t=new Cn({props:{rootNoteIndex:e[1],selectedScaleName:e[3].name}});let Ce=[...e[3].scale],H=[];for(let f=0;f<Ce.length;f+=1)H[f]=Xt(jt(e,Ce,f));i=new An({props:{notePositionCircle:e[6],rootNoteIndex:e[1],selectedScaleNotes:e[3].scale}});let Fe=bt,J=[];for(let f=0;f<Fe.length;f+=1)J[f]=$t(Ut(e,Fe,f));let we=e[2].modes,W=[];for(let f=0;f<we.length;f+=1)W[f]=Ht(qt(e,we,f));let Pe=e[2].modes,K=[];for(let f=0;f<Pe.length;f+=1)K[f]=Jt(Vt(e,Pe,f));return de=new Pn({props:{bpm:e[4],rootNoteIndex:e[1],selectedModesGroup:e[2],selectedScaleNotes:e[3].scale}}),{c(){ht(t.$$.fragment),l=A(),n=E("div"),o=x("svg"),a=x("circle");for(let f=0;f<H.length;f+=1)H[f].c();r=$e(),ht(i.$$.fragment),u=A(),c=E("div"),m=E("div"),_=w(`Root note
			`),I=E("button"),y=w("-"),p=A(),k=E("span"),U=w(T),O=A(),S=E("button"),C=w("+"),j=A(),te=E("div"),G=w(`Mode type
			`);for(let f=0;f<J.length;f+=1)J[f].c();ne=A(),ue=E("div"),L=E("div"),D=E("div"),oe=E("h2"),ke=w("Equivalent "),ve=w(he),Qe=w(" modes"),Ye=A();for(let f=0;f<W.length;f+=1)W[f].c();Ze=A(),Be=E("div"),me=E("div"),Ie=E("h2"),xe=w("Modes by modification"),et=A();for(let f=0;f<K.length;f+=1)K[f].c();tt=A(),Te=E("div"),ht(de.$$.fragment),nt=A(),Ee=E("div"),Ne=E("div"),fe=E("div"),Me=E("button"),lt=w("-"),ot=A(),pe=E("span"),Le=w(e[4]),at=w(" bpm"),rt=A(),Se=E("button"),st=w("+"),this.h()},l(f){ft(t.$$.fragment,f),l=B(f),n=N(f,"DIV",{class:!0,"data-sveltekit-preload-data":!0});var F=b(n);o=ee(F,"svg",{id:!0,viewBox:!0,xmlns:!0,class:!0});var R=b(o);a=ee(R,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0,class:!0}),b(a).forEach(g);for(let Q=0;Q<H.length;Q+=1)H[Q].l(R);r=$e(),ft(i.$$.fragment,R),R.forEach(g),u=B(F),c=N(F,"DIV",{class:!0});var Y=b(c);m=N(Y,"DIV",{});var le=b(m);_=P(le,`Root note
			`),I=N(le,"BUTTON",{});var v=b(I);y=P(v,"-"),v.forEach(g),p=B(le),k=N(le,"SPAN",{class:!0});var Z=b(k);U=P(Z,T),Z.forEach(g),O=B(le),S=N(le,"BUTTON",{});var Tt=b(S);C=P(Tt,"+"),Tt.forEach(g),le.forEach(g),j=B(Y),te=N(Y,"DIV",{});var ct=b(te);G=P(ct,`Mode type
			`);for(let Q=0;Q<J.length;Q+=1)J[Q].l(ct);ct.forEach(g),ne=B(Y),ue=N(Y,"DIV",{});var ze=b(ue);L=N(ze,"DIV",{});var Et=b(L);D=N(Et,"DIV",{});var Ve=b(D);oe=N(Ve,"H2",{class:!0});var qe=b(oe);ke=P(qe,"Equivalent "),ve=P(qe,he),Qe=P(qe," modes"),qe.forEach(g),Ye=B(Ve);for(let Q=0;Q<W.length;Q+=1)W[Q].l(Ve);Ve.forEach(g),Et.forEach(g),Ze=B(ze),Be=N(ze,"DIV",{});var Nt=b(Be);me=N(Nt,"DIV",{});var Ue=b(me);Ie=N(Ue,"H2",{class:!0});var Mt=b(Ie);xe=P(Mt,"Modes by modification"),Mt.forEach(g),et=B(Ue);for(let Q=0;Q<K.length;Q+=1)K[Q].l(Ue);Ue.forEach(g),Nt.forEach(g),ze.forEach(g),tt=B(Y),Te=N(Y,"DIV",{class:!0});var St=b(Te);ft(de.$$.fragment,St),St.forEach(g),nt=B(Y),Ee=N(Y,"DIV",{class:!0});var Ct=b(Ee);Ne=N(Ct,"DIV",{class:!0});var Ft=b(Ne);fe=N(Ft,"DIV",{});var De=b(fe);Me=N(De,"BUTTON",{});var wt=b(Me);lt=P(wt,"-"),wt.forEach(g),ot=B(De),pe=N(De,"SPAN",{class:!0});var ut=b(pe);Le=P(ut,e[4]),at=P(ut," bpm"),ut.forEach(g),rt=B(De),Se=N(De,"BUTTON",{});var Pt=b(Se);st=P(Pt,"+"),Pt.forEach(g),De.forEach(g),Ft.forEach(g),Ct.forEach(g),Y.forEach(g),F.forEach(g),this.h()},h(){s(a,"cx",e[5].xCentre),s(a,"cy",e[5].yCentre),s(a,"r",e[5].radius),s(a,"stroke","grey"),s(a,"stroke-width",1),s(a,"fill","var(--base-background-color)"),s(a,"class","background svelte-xzpph0"),s(o,"id","boxOfNotes"),s(o,"viewBox","0 0 800 800"),s(o,"xmlns","http://www.w3.org/2000/svg"),s(o,"class","svelte-xzpph0"),s(k,"class","noteLabel svelte-xzpph0"),s(oe,"class","svelte-xzpph0"),s(Ie,"class","svelte-xzpph0"),s(Te,"class","musicControls svelte-xzpph0"),s(pe,"class","noteLabel svelte-xzpph0"),s(Ne,"class","svelte-xzpph0"),s(Ee,"class","musicControls svelte-xzpph0"),s(c,"class","boxOfButtons svelte-xzpph0"),s(n,"class","appContainer svelte-xzpph0"),s(n,"data-sveltekit-preload-data","hover")},m(f,F){mt(t,f,F),re(f,l,F),re(f,n,F),h(n,o),h(o,a);for(let R=0;R<H.length;R+=1)H[R].m(o,null);h(o,r),mt(i,o,null),h(n,u),h(n,c),h(c,m),h(m,_),h(m,I),h(I,y),h(m,p),h(m,k),h(k,U),h(m,O),h(m,S),h(S,C),h(c,j),h(c,te),h(te,G);for(let R=0;R<J.length;R+=1)J[R].m(te,null);h(c,ne),h(c,ue),h(ue,L),h(L,D),h(D,oe),h(oe,ke),h(oe,ve),h(oe,Qe),h(D,Ye);for(let R=0;R<W.length;R+=1)W[R].m(D,null);h(ue,Ze),h(ue,Be),h(Be,me),h(me,Ie),h(Ie,xe),h(me,et);for(let R=0;R<K.length;R+=1)K[R].m(me,null);h(c,tt),h(c,Te),mt(de,Te,null),h(c,nt),h(c,Ee),h(Ee,Ne),h(Ne,fe),h(fe,Me),h(Me,lt),h(fe,ot),h(fe,pe),h(pe,Le),h(pe,at),h(fe,rt),h(fe,Se),h(Se,st),be=!0,it||(It=[$(I,"click",e[13]),$(S,"click",e[14]),$(Me,"click",e[18]),$(Se,"click",e[19])],it=!0)},p(f,F){const R={};if(F[0]&2&&(R.rootNoteIndex=f[1]),F[0]&8&&(R.selectedScaleName=f[3].name),t.$set(R),F[0]&479){Ce=[...f[3].scale];let v;for(v=0;v<Ce.length;v+=1){const Z=jt(f,Ce,v);H[v]?H[v].p(Z,F):(H[v]=Xt(Z),H[v].c(),H[v].m(o,r))}for(;v<H.length;v+=1)H[v].d(1);H.length=Ce.length}const Y={};if(F[0]&2&&(Y.rootNoteIndex=f[1]),F[0]&8&&(Y.selectedScaleNotes=f[3].scale),i.$set(Y),(!be||F[0]&2)&&T!==(T=ce(d[M(f[1],d.length)])+"")&&ae(U,T),F[0]&12){Fe=bt;let v;for(v=0;v<Fe.length;v+=1){const Z=Ut(f,Fe,v);J[v]?J[v].p(Z,F):(J[v]=$t(Z),J[v].c(),J[v].m(te,null))}for(;v<J.length;v+=1)J[v].d(1);J.length=Fe.length}if((!be||F[0]&4)&&he!==(he=f[2].label+"")&&ae(ve,he),F[0]&15){we=f[2].modes;let v;for(v=0;v<we.length;v+=1){const Z=qt(f,we,v);W[v]?W[v].p(Z,F):(W[v]=Ht(Z),W[v].c(),W[v].m(D,null))}for(;v<W.length;v+=1)W[v].d(1);W.length=we.length}if(F[0]&15){Pe=f[2].modes;let v;for(v=0;v<Pe.length;v+=1){const Z=Vt(f,Pe,v);K[v]?K[v].p(Z,F):(K[v]=Jt(Z),K[v].c(),K[v].m(me,null))}for(;v<K.length;v+=1)K[v].d(1);K.length=Pe.length}const le={};F[0]&16&&(le.bpm=f[4]),F[0]&2&&(le.rootNoteIndex=f[1]),F[0]&4&&(le.selectedModesGroup=f[2]),F[0]&8&&(le.selectedScaleNotes=f[3].scale),de.$set(le),(!be||F[0]&16)&&ae(Le,f[4])},i(f){be||(dt(t.$$.fragment,f),dt(i.$$.fragment,f),dt(de.$$.fragment,f),be=!0)},o(f){_t(t.$$.fragment,f),_t(i.$$.fragment,f),_t(de.$$.fragment,f),be=!1},d(f){gt(t,f),f&&g(l),f&&g(n),Oe(H,f),gt(i),Oe(J,f),Oe(W,f),Oe(K,f),gt(de),it=!1,Ke(It)}}}function On(e,t,l){const n={xCentre:400,yCentre:400,radius:300};let o=!0;const a={...n,radius:n.radius},r={...n,radius:n.radius-70},i={...n,radius:n.radius+70};let u=0,c=bt[0],m=c.modes[0],_=70;return[o,u,c,m,_,n,a,r,i,G=>At(u,G,m.scale,60*1e3/_),(G,ne)=>ne.key==="Enter"&&At(u,G,m.scale,60*1e3/_),G=>Bt(G,u,60*1e3/_),(G,ne)=>ne.key==="Enter"&&Bt(G,u,60*1e3/_),()=>{l(1,u=u-1),u<0&&l(1,u=u+12)},()=>{l(1,u=u+1),u>=12&&l(1,u=u-12)},G=>{c!==G&&(l(2,c=G),l(3,m=G.modes[0]))},(G,ne)=>{l(3,m=G),l(1,u=M(ne,d.length)),l(0,o=!0)},(G,ne)=>{l(3,m=G),l(1,u=M(ne,d.length)),l(0,o=!1)},()=>{_>10&&l(4,_=_-20)},()=>{l(4,_=_+20)}]}class zn extends He{constructor(t){super(),Je(this,t,On,Bn,We,{},null,[-1,-1])}}export{zn as default};
