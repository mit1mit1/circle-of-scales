import{S as ht,i as ft,s as mt,k as N,q as C,a as B,l as M,m as y,r as P,c as O,h as p,n as s,b as ie,G as c,u as oe,H as Oe,J as H,K as He,y as Nt,L as ee,e as Mt,z as St,M as te,A as Ft,g as wt,d as Ct,B as Pt,N as Be,p as re,O as _e}from"../chunks/index.7d8db591.js";import{w as Kt}from"../chunks/index.10bcb82c.js";const S=(e,t)=>{const l=e%t;return l<0?l+t:l},Qt=e=>{if(isNaN(e))return"NaN";const t=String(+e).split("")??[],l=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let n="",o=3;for(;o--;)n=(l[+(t.pop()??"")+o*10]||"")+n;return Array(+t.join("")+1).join("M")+n},V=(e,t,l)=>{let n=0;for(let o=e;o<t;o++)n+=l[S(o,l.length)];return n},d=[{sharpNote:"C",flatNote:"C",defaultOctaveFrequency:261.63},{sharpNote:"C#",flatNote:"D♭",preferSharp:!0,defaultOctaveFrequency:277.18},{sharpNote:"D",flatNote:"D",defaultOctaveFrequency:293.66},{sharpNote:"D#",flatNote:"E♭",preferSharp:!1,defaultOctaveFrequency:311.13},{sharpNote:"E",flatNote:"E",defaultOctaveFrequency:329.63},{sharpNote:"F",flatNote:"F",defaultOctaveFrequency:349.23},{sharpNote:"F#",flatNote:"G♭",preferSharp:!0,defaultOctaveFrequency:185},{sharpNote:"G",flatNote:"G",defaultOctaveFrequency:196},{sharpNote:"G#",flatNote:"A♭",preferSharp:!1,defaultOctaveFrequency:207.65},{sharpNote:"A",flatNote:"A",defaultOctaveFrequency:220},{sharpNote:"A#",flatNote:"B♭",preferSharp:!1,defaultOctaveFrequency:233.08},{sharpNote:"A",flatNote:"B",defaultOctaveFrequency:246.94}],$=[2,2,1,2,2,2,1],se=[2,2,3,2,3],ve=[3,2,1,1,3,2],Xe=[1,256/243,9/8,32/27,81/64,4/3,1024/729,3/2,128/81,27/16,16/9,243/128],st={pentatonic:[.3,.05,.05,.2,.1],diatonic:[.3,.05,.15,.05,.075,.05,.03],hexatonic:[.3,.075,.15,.075,.075,.05]},it={pentatonic:[.5,.05,.15,.2,.05],diatonic:[.5,.02,.05,.1,.1,.05,.02],hexatonic:[.5,.02,.05,.1,.1,.05]},Re=.25,Jt=(e,t)=>e===4&&t===7?"major":e===3&&t===7?"minor":e===3&&t===6?"diminished":"bizarre",Dt=(e,t)=>{const l=[{...t[e]},{...t[S(e+2,t.length)]},{...t[S(e+4,t.length)]}];return Jt(l[1].semitonesFromRoot,l[1].semitonesFromRoot+l[2].semitonesFromRoot)},Wt=e=>Jt(e.firstInterval.semitonesFromRoot,e.secondInterval.semitonesFromRoot),Yt=(e,t)=>({firstInterval:{semitonesFromRoot:V(e,e+2,t)},secondInterval:{semitonesFromRoot:V(e,e+4,t)}}),Zt=(e,t,l)=>{const n=Qt(S(e+1,l.length+1)),o=e+t,a=Wt(Yt(o,l));return a==="major"?n:a==="minor"?n.toLowerCase():a==="diminished"?`${n.toLowerCase()}°`:n},U=(e,t)=>{const l=[];for(let n=0;n<t.length;n++)l.push({semitonesFromRoot:V(e,e+n,t),label:Zt(n,e,t)});return l},Rt=(e,t)=>{const l=t+1;if(e===1)return`A${l}`;if([1,4,5].includes(l)){if(e===0)return`P${l}`;if(e===-1)return`d${l}`}if(e===0)return`M${l}`;if(e===-1)return`m${l}`;if(e===-2)return`d${l}`},$e=(e,t)=>{const l=e.semitonesFromRoot-V(0,t,$),n=Rt(l,t);if(n)return n;let o=0;for(;o<$.length;){const a=e.semitonesFromRoot-V(0,o,$),r=Rt(a,o);if(r)return r;o++}return`${e.semitonesFromRoot}s`},xt=U(0,$),en=U(1,$),tn=U(2,$),nn=U(3,$),ln=U(4,$),on=U(5,$),an=U(6,$),rn=[{name:"Ionian / Major",scale:xt,rootIntervalToIonian:V(0,0,$)},{name:"Dorian",scale:en,rootIntervalToIonian:V(0,1,$)},{name:"Phrygian",scale:tn,rootIntervalToIonian:V(0,2,$)},{name:"Lydian",scale:nn,rootIntervalToIonian:V(0,3,$)},{name:"Mixolydian",scale:ln,rootIntervalToIonian:V(0,4,$)},{name:"Aeolian / Natural Minor",scale:on,rootIntervalToIonian:V(0,5,$)},{name:"Locrian",scale:an,rootIntervalToIonian:V(0,6,$)}],sn=U(0,se),cn=U(1,se),un=U(2,se),hn=U(3,se),fn=U(4,se),mn=[{name:"Major",scale:sn,rootIntervalToIonian:V(0,0,se)},{name:"Suspended / Egyptian",scale:cn,rootIntervalToIonian:V(0,1,se)},{name:"Blues minor / Man Gong",scale:un,rootIntervalToIonian:V(0,2,se)},{name:"Blues major",scale:hn,rootIntervalToIonian:V(0,3,se)},{name:"Minor",scale:fn,rootIntervalToIonian:V(0,4,se)}],dn=U(0,ve),_n=U(1,ve);U(2,ve);U(3,ve);U(4,ve);U(5,ve);const vn=[{name:"Minor",scale:dn,rootIntervalToIonian:V(0,0,ve)},{name:"Major",scale:_n,rootIntervalToIonian:V(0,1,ve)}],ct=[{label:"Diatonic",modes:rn,probabilityDistributions:{bass:it.diatonic,melody:st.diatonic}},{label:"Pentatonic",modes:mn,probabilityDistributions:{bass:it.pentatonic,melody:st.pentatonic}},{label:"Hexatonic (blues)",modes:vn,probabilityDistributions:{bass:it.hexatonic,melody:st.hexatonic}}],ut=Kt({}),Ae=300,Ge=.75,gn=12,pn=1e-6,bn={attackTime:.1,decayTime:.3,releaseTime:.5,maxSustainTime:.2,maxGain:.1,sustainGainRatio:.1,oscillatorType:"sine"},yn=(e,t)=>{let l=1;for(;t<0;)t=t+Xe.length,l=l*.5;for(;t>=Xe.length;)t=t-Xe.length,l=l*2;return l=l*Xe[t],e.defaultOctaveFrequency*l},G=(e,t,l,n,o={})=>{if(n<l){console.log("Warning: note end time earlier than start time");return}const a={...bn,...o};let{attackTime:r,decayTime:i}={...a};const{releaseTime:f,maxSustainTime:u,maxGain:_,sustainGainRatio:v,oscillatorType:E="triangle"}={...a},k=_*v,g=new AudioContext,b=g.createOscillator(),I=g.createGain(),j=g.createDynamicsCompressor();I.gain.value=.001,b.type=E,b.frequency.value=yn(e,t),b.connect(I).connect(j).connect(g.destination);const z=n-l;r>z/(2*1e3)&&(r=z/(2*1e3)),i+r>z/1e3&&(i=z/1e3-r);let J=u??1e4;J>z/1e3-r-i&&(J=z/1e3-r-i),setTimeout(function(){const ne=g.currentTime+r;I.gain.exponentialRampToValueAtTime(_,ne),ut.update(q=>({...q,[S(t,d.length)]:(q[`${S(t,d.length)}`]??0)+1})),b.start(),setTimeout(()=>{I.gain.exponentialRampToValueAtTime(k,g.currentTime+i),setTimeout(()=>{I.gain.exponentialRampToValueAtTime(pn,g.currentTime+f),ut.update(q=>{const ue=Math.max((q[`${S(t,d.length)}`]??0)-1,0);return console.log("removing",S(t,d.length),"from",q,"to give",ue),{...q,[S(t,d.length)]:ue}}),setTimeout(function(){b.stop(),g.close()},f*1e3+2e3)},J*1e3)},r*1e3)},l)},At=(e,t,l,n=Ae,o=Ge)=>{const a=n*.5*o,r=n*.5-a,i=n*.5,f=[{...l[t]},{...l[S(t+2,l.length)]},{...l[S(t+4,l.length)]}];f.forEach((u,_)=>{_<=0||(console.log(u.semitonesFromRoot<f[_-1].semitonesFromRoot,u.semitonesFromRoot,f[_-1].semitonesFromRoot),u.semitonesFromRoot<f[_-1].semitonesFromRoot&&(u.semitonesFromRoot+=d.length))}),console.log("mapped scale notes",f),[...f].forEach((u,_)=>{G(d[e],u.semitonesFromRoot,_*i+r,_*i+r+a+i)}),[...f].forEach(u=>{G(d[e],u.semitonesFromRoot,(f.length+1)*i+r,(f.length+1)*i+r+(a+i)*2)})},zt=(e,t,l=Ae,n=Ge)=>{const o=l*.5*n,a=l*.5-o,r=l*.5;[...[{semitonesFromRoot:0},e]].forEach((f,u)=>{G(d[t],f.semitonesFromRoot,u*r+a,u*r+a+o+r)})},kn=(e,t,l=Ae,n=Ge)=>{const o=l*.5*n,a=l*.5-o,r=l*.5;[...e].forEach((i,f)=>{f===0?G(d[t],i.semitonesFromRoot,f*2*r+a,f*2*r+a+o+r):(G(d[t],0,f*2*r+a,f*2*r+a+o),G(d[t],i.semitonesFromRoot,(f*2+1)*r+a,(f*2+1)*r+a+o))}),G(d[t],0,e.length*2*r+a,e.length*2*r+a+o),G(d[t],d.length,(e.length*2+1)*r+a,(e.length*2+1)*r+a+o)},In=(e,t,l=Ae,n=Ge)=>{const o=l*.5*n,a=l*.5-o,r=l*.5;G(d[t],e[0].semitonesFromRoot,a,r+a+o+r),[...e].forEach((i,f)=>{G(d[t],i.semitonesFromRoot,(f+2)*r+a,(f+2)*r+a+o+r)}),G(d[t],d.length,(e.length+2)*r+a,(e.length+2)*r+a+o),[...e].reverse().forEach((i,f)=>{G(d[t],i.semitonesFromRoot,(f+e.length+3)*r+a,(f+e.length+3)*r+a+o+r)})},Tn=(e,t,l=Ae,n=Ge)=>{const o=l*.5*n,a=l*.5-o,r=l*.5;G(d[t],0,a,a+r*(e.length*2+3),{maxSustainTime:r*(e.length*2+2),oscillatorType:"sine",sustainGainRatio:.5,maxGain:.0125}),[...e].forEach((i,f)=>{G(d[t],i.semitonesFromRoot,(f+2)*r+a,(f+2)*r+a+o+r)}),G(d[t],d.length,(e.length+2)*r+a,(e.length+2)*r+a+o),[...e].reverse().forEach((i,f)=>{G(d[t],i.semitonesFromRoot,(f+e.length+3)*r+a,(f+e.length+3)*r+a+o+r)})},En=(e,t,l,n,o=Ae,a=gn)=>{let r=0;for(;r<=a;)e.forEach((f,u)=>{if(!(u>=l.length)&&Math.random()<l[u]){const _=Math.random();let v=1;_>.8&&(v=2),_>.9&&(v=4),_>.95&&(v=6),_>.97&&(v=3),_>.99&&(v=8),G(d[t],f.semitonesFromRoot+d.length,o*r,o*r+o*Re*v),r+=Re}}),r+=Re;let i=0;for(;i<=a;)e.forEach((f,u)=>{if(!(u>=n.length)&&Math.random()<n[u]){const _=Math.random();let v=1;_>.8&&(v=2),_>.9&&(v=4),_>.95&&(v=6),_>.97&&(v=3),_>.99&&(v=8),G(d[t],f.semitonesFromRoot,o*i,o*i+o*2*Re*v),i+=2*Re}}),i+=2*Re},ce=e=>e.preferSharp?e.sharpNote:e.flatNote,Bt=(e,t,l)=>{let n=S(e-t,d.length);return n<0&&(n=n+d.length),l.some(o=>o.semitonesFromRoot===n)};function Nn(e){let t,l=ce(d[S(e[0],d.length)])+"",n,o,a;return{c(){t=N("h1"),n=C(l),o=B(),a=C(e[1]),this.h()},l(r){t=M(r,"H1",{class:!0});var i=y(t);n=P(i,l),o=O(i),a=P(i,e[1]),i.forEach(p),this.h()},h(){s(t,"class","svelte-10dbiud")},m(r,i){ie(r,t,i),c(t,n),c(t,o),c(t,a)},p(r,[i]){i&1&&l!==(l=ce(d[S(r[0],d.length)])+"")&&oe(n,l),i&2&&oe(a,r[1])},i:Oe,o:Oe,d(r){r&&p(t)}}}function Mn(e,t,l){let{rootNoteIndex:n}=t,{selectedScaleName:o}=t;return e.$$set=a=>{"rootNoteIndex"in a&&l(0,n=a.rootNoteIndex),"selectedScaleName"in a&&l(1,o=a.selectedScaleName)},[n,o]}class Sn extends ht{constructor(t){super(),ft(this,t,Mn,Nn,mt,{rootNoteIndex:0,selectedScaleName:1})}}function Fn(e){let t,l,n,o,a,r,i,f,u,_,v,E,k,g;return{c(){t=N("div"),l=N("button"),n=C("▶ Scale"),o=B(),a=N("button"),r=C("▶ Scale + Pedal"),i=B(),f=N("button"),u=C("▶ Scale + Drone"),_=B(),v=N("button"),E=C("▶ Jam")},l(b){t=M(b,"DIV",{});var I=y(t);l=M(I,"BUTTON",{});var j=y(l);n=P(j,"▶ Scale"),j.forEach(p),o=O(I),a=M(I,"BUTTON",{});var z=y(a);r=P(z,"▶ Scale + Pedal"),z.forEach(p),i=O(I),f=M(I,"BUTTON",{});var J=y(f);u=P(J,"▶ Scale + Drone"),J.forEach(p),_=O(I),v=M(I,"BUTTON",{});var ne=y(v);E=P(ne,"▶ Jam"),ne.forEach(p),I.forEach(p)},m(b,I){ie(b,t,I),c(t,l),c(l,n),c(t,o),c(t,a),c(a,r),c(t,i),c(t,f),c(f,u),c(t,_),c(t,v),c(v,E),k||(g=[H(l,"click",e[4]),H(a,"click",e[5]),H(f,"click",e[6]),H(v,"click",e[7])],k=!0)},p:Oe,i:Oe,o:Oe,d(b){b&&p(t),k=!1,He(g)}}}function wn(e,t,l){let{rootNoteIndex:n}=t,{bpm:o}=t,{selectedScaleNotes:a}=t,{selectedModesGroup:r}=t;const i=()=>{In(a,n,60*1e3/o)},f=()=>{kn(a,n,60*1e3/o)},u=()=>{Tn(a,n,60*1e3/o)},_=()=>{En(a,n,r.probabilityDistributions.melody,r.probabilityDistributions.bass,60*1e3/o)};return e.$$set=v=>{"rootNoteIndex"in v&&l(0,n=v.rootNoteIndex),"bpm"in v&&l(1,o=v.bpm),"selectedScaleNotes"in v&&l(2,a=v.selectedScaleNotes),"selectedModesGroup"in v&&l(3,r=v.selectedModesGroup)},[n,o,a,r,i,f,u,_]}class Cn extends ht{constructor(t){super(),ft(this,t,wn,Fn,mt,{rootNoteIndex:0,bpm:1,selectedScaleNotes:2,selectedModesGroup:3})}}function Ot(e,t,l){const n=e.slice();n[25]=t[l];const o=n[2];return n[26]=o,n}function Gt(e,t,l){const n=e.slice();n[25]=t[l];const o=n[2]+n[25].rootIntervalToIonian-n[4].rootIntervalToIonian;return n[26]=o,n}function Lt(e,t,l){const n=e.slice();return n[31]=t[l],n}function Vt(e,t,l){const n=e.slice();n[34]=t[l],n[37]=l;const o=n[10](n[37],n[7]);return n[35]=o,n}function qt(e,t,l){const n=e.slice();n[38]=t[l],n[42]=l;const o=n[1]?n[10](n[4].scale[S(n[42]-n[3].modes.findIndex(i=>i===n[4]),n[4].scale.length)].semitonesFromRoot+n[2],n[7]):n[10](n[38].semitonesFromRoot+n[2],n[7]);n[35]=o;const a=n[11](n[38],n[2],n[8]);n[39]=a;const r=n[11](n[38],n[2],n[9]);return n[40]=r,n}function Ut(e){let t,l,n,o,a,r,i,f=e[38].label+"",u,_,v,E,k,g,b,I=$e(e[38],e[42])+"",j,z,J,ne,q;function ue(){return e[12](e[42])}function be(...A){return e[13](e[42],...A)}function ae(){return e[14](e[38])}function fe(...A){return e[15](e[38],...A)}return{c(){t=ee("circle"),n=ee("g"),o=ee("g"),a=ee("circle"),i=ee("text"),u=C(f),E=ee("g"),k=ee("circle"),b=ee("text"),j=C(I),this.h()},l(A){t=te(A,"circle",{style:!0,cx:!0,cy:!0,r:!0,transform:!0,stroke:!0,fill:!0,class:!0}),y(t).forEach(p),n=te(A,"g",{class:!0});var D=y(n);o=te(D,"g",{class:!0,tabindex:!0,"aria-label":!0,role:!0});var T=y(o);a=te(T,"circle",{style:!0,cx:!0,cy:!0,r:!0,transform:!0,stroke:!0,fill:!0}),y(a).forEach(p),i=te(T,"text",{x:!0,y:!0,"text-anchor":!0,dy:!0,transform:!0,class:!0});var R=y(i);u=P(R,f),R.forEach(p),T.forEach(p),E=te(D,"g",{class:!0,tabindex:!0,"aria-label":!0,role:!0});var le=y(E);k=te(le,"circle",{style:!0,cx:!0,cy:!0,r:!0,transform:!0,stroke:!0,fill:!0}),y(k).forEach(p),b=te(le,"text",{x:!0,y:!0,"text-anchor":!0,dy:!0,transform:!0,class:!0});var ye=y(b);j=P(ye,I),ye.forEach(p),le.forEach(p),D.forEach(p),this.h()},h(){re(t,"stroke-width","1.6871"),re(t,"stroke-miterlimit","10"),s(t,"cx",0),s(t,"cy",0),s(t,"r",30),s(t,"transform",l=`translate(${e[35].x} ${e[35].y})`),s(t,"stroke","black"),s(t,"fill","transparent"),s(t,"class","transitionAll svelte-1b4p12z"),re(a,"stroke-width","1.6871"),re(a,"stroke-miterlimit","10"),s(a,"cx",0),s(a,"cy",0),s(a,"r",30),s(a,"transform",r=`translate(${e[39].x} ${e[39].y})`),s(a,"stroke","transparent"),s(a,"fill","transparent"),s(i,"x",0),s(i,"y",0),s(i,"text-anchor","middle"),s(i,"dy",".3em"),s(i,"transform",_=`translate(${e[39].x} ${e[39].y})`),s(i,"class","svgNoteName scaleNote transitionAll svelte-1b4p12z"),s(o,"class","clickable svelte-1b4p12z"),s(o,"tabindex","0"),s(o,"aria-label",v=`Play ${d[S(e[2]+e[38].semitonesFromRoot,d.length)]} ${Dt(e[42],e[4].scale)} triad`),s(o,"role","button"),re(k,"stroke-width","1.6871"),re(k,"stroke-miterlimit","10"),s(k,"cx",0),s(k,"cy",0),s(k,"r",30),s(k,"transform",g=`translate(${e[40].x} ${e[40].y})`),s(k,"stroke","transparent"),s(k,"fill","transparent"),s(b,"x",0),s(b,"y",0),s(b,"text-anchor","middle"),s(b,"dy",".3em"),s(b,"transform",z=`translate(${e[40].x} ${e[40].y})`),s(b,"class","svgNoteName scaleNote transitionAll svelte-1b4p12z"),s(E,"class","clickable svelte-1b4p12z"),s(E,"tabindex","0"),s(E,"aria-label",J=`Play ${$e(e[38],e[42])} interval`),s(E,"role","button"),s(n,"class","transitionNote")},m(A,D){ie(A,t,D),ie(A,n,D),c(n,o),c(o,a),c(o,i),c(i,u),c(n,E),c(E,k),c(E,b),c(b,j),ne||(q=[H(o,"click",ue),H(o,"keydown",be),H(E,"click",ae),H(E,"keydown",fe)],ne=!0)},p(A,D){e=A,D[0]&30&&l!==(l=`translate(${e[35].x} ${e[35].y})`)&&s(t,"transform",l),D[0]&20&&r!==(r=`translate(${e[39].x} ${e[39].y})`)&&s(a,"transform",r),D[0]&16&&f!==(f=e[38].label+"")&&oe(u,f),D[0]&20&&_!==(_=`translate(${e[39].x} ${e[39].y})`)&&s(i,"transform",_),D[0]&20&&v!==(v=`Play ${d[S(e[2]+e[38].semitonesFromRoot,d.length)]} ${Dt(e[42],e[4].scale)} triad`)&&s(o,"aria-label",v),D[0]&20&&g!==(g=`translate(${e[40].x} ${e[40].y})`)&&s(k,"transform",g),D[0]&16&&I!==(I=$e(e[38],e[42])+"")&&oe(j,I),D[0]&20&&z!==(z=`translate(${e[40].x} ${e[40].y})`)&&s(b,"transform",z),D[0]&16&&J!==(J=`Play ${$e(e[38],e[42])} interval`)&&s(E,"aria-label",J)},d(A){A&&p(t),A&&p(n),ne=!1,He(q)}}}function jt(e){let t,l,n,o,a,r,i,f=ce(e[34])+"",u,_,v,E;function k(){return e[16](e[37])}function g(...b){return e[17](e[37],...b)}return{c(){t=ee("g"),l=ee("circle"),o=ee("circle"),i=ee("text"),u=C(f),this.h()},l(b){t=te(b,"g",{class:!0,tabindex:!0,"aria-label":!0,role:!0});var I=y(t);l=te(I,"circle",{style:!0,cx:!0,cy:!0,r:!0,transform:!0,stroke:!0,fill:!0}),y(l).forEach(p),o=te(I,"circle",{style:!0,cx:!0,cy:!0,r:!0,transform:!0,stroke:!0,fill:!0,opacity:!0,class:!0}),y(o).forEach(p),i=te(I,"text",{x:!0,y:!0,class:!0,"text-anchor":!0,dy:!0});var j=y(i);u=P(j,f),j.forEach(p),I.forEach(p),this.h()},h(){re(l,"stroke-width","1.6871"),re(l,"stroke-miterlimit","10"),s(l,"cx",0),s(l,"cy",0),s(l,"r",30),s(l,"transform",`translate(${e[35].x} ${e[35].y})`),s(l,"stroke","transparent"),s(l,"fill",n=e[37]===e[2]?"yellow":"var(--base-background-color)"),re(o,"stroke-width","1.6871"),re(o,"stroke-miterlimit","10"),s(o,"cx",0),s(o,"cy",0),s(o,"r",30),s(o,"transform",`translate(${e[35].x} ${e[35].y})`),s(o,"stroke","transparent"),s(o,"fill",a=e[0][`${S(e[37]-e[2],d.length)}`]>0?"blue":"var(--base-background-color)"),s(o,"opacity",r=(e[0][`${S(e[37]-e[2],d.length)}`]??0)/3),s(o,"class","transitionAllQuick svelte-1b4p12z"),s(i,"x",e[35].x),s(i,"y",e[35].y),s(i,"class",_=_e(`svgNoteName ${Bt(e[37],e[2],e[4].scale)?"svgSelectedNoteName":""}`)+" svelte-1b4p12z"),s(i,"text-anchor","middle"),s(i,"dy",".3em"),s(t,"class","clickable svelte-1b4p12z"),s(t,"tabindex","0"),s(t,"aria-label",`Play ${ce(e[34])}`),s(t,"role","button")},m(b,I){ie(b,t,I),c(t,l),c(t,o),c(t,i),c(i,u),v||(E=[H(t,"click",k),H(t,"keydown",g)],v=!0)},p(b,I){e=b,I[0]&4&&n!==(n=e[37]===e[2]?"yellow":"var(--base-background-color)")&&s(l,"fill",n),I[0]&5&&a!==(a=e[0][`${S(e[37]-e[2],d.length)}`]>0?"blue":"var(--base-background-color)")&&s(o,"fill",a),I[0]&5&&r!==(r=(e[0][`${S(e[37]-e[2],d.length)}`]??0)/3)&&s(o,"opacity",r),I[0]&20&&_!==(_=_e(`svgNoteName ${Bt(e[37],e[2],e[4].scale)?"svgSelectedNoteName":""}`)+" svelte-1b4p12z")&&s(i,"class",_)},d(b){b&&p(t),v=!1,He(E)}}}function Xt(e){let t,l=e[31].label+"",n,o,a,r,i;function f(){return e[20](e[31])}return{c(){t=N("button"),n=C(l),o=B(),this.h()},l(u){t=M(u,"BUTTON",{class:!0});var _=y(t);n=P(_,l),o=O(_),_.forEach(p),this.h()},h(){s(t,"class",a=_e(e[3]===e[31]?"selectedTab":"")+" svelte-1b4p12z")},m(u,_){ie(u,t,_),c(t,n),c(t,o),r||(i=H(t,"click",f),r=!0)},p(u,_){e=u,_[0]&8&&a!==(a=_e(e[3]===e[31]?"selectedTab":"")+" svelte-1b4p12z")&&s(t,"class",a)},d(u){u&&p(t),r=!1,i()}}}function $t(e){let t,l,n=ce(d[S(e[26],d.length)])+"",o,a,r=e[25].name+"",i,f,u,_,v;function E(){return e[21](e[25],e[26])}return{c(){t=N("button"),l=N("span"),o=C(n),a=B(),i=C(r),f=B(),this.h()},l(k){t=M(k,"BUTTON",{class:!0});var g=y(t);l=M(g,"SPAN",{class:!0});var b=y(l);o=P(b,n),b.forEach(p),a=O(g),i=P(g,r),f=O(g),g.forEach(p),this.h()},h(){s(l,"class","noteLabel svelte-1b4p12z"),s(t,"class",u=_e(e[25]===e[4]&&e[1]?"selectedTab":"")+" svelte-1b4p12z")},m(k,g){ie(k,t,g),c(t,l),c(l,o),c(t,a),c(t,i),c(t,f),_||(v=H(t,"click",E),_=!0)},p(k,g){e=k,g[0]&28&&n!==(n=ce(d[S(e[26],d.length)])+"")&&oe(o,n),g[0]&8&&r!==(r=e[25].name+"")&&oe(i,r),g[0]&26&&u!==(u=_e(e[25]===e[4]&&e[1]?"selectedTab":"")+" svelte-1b4p12z")&&s(t,"class",u)},d(k){k&&p(t),_=!1,v()}}}function Ht(e){let t,l,n=ce(d[S(e[26],d.length)])+"",o,a,r=e[25].name+"",i,f,u,_,v;function E(){return e[22](e[25],e[26])}return{c(){t=N("button"),l=N("span"),o=C(n),a=B(),i=C(r),f=B(),this.h()},l(k){t=M(k,"BUTTON",{class:!0});var g=y(t);l=M(g,"SPAN",{class:!0});var b=y(l);o=P(b,n),b.forEach(p),a=O(g),i=P(g,r),f=O(g),g.forEach(p),this.h()},h(){s(l,"class","noteLabel svelte-1b4p12z"),s(t,"class",u=_e(e[25]===e[4]&&!e[1]?"selectedTab":"")+" svelte-1b4p12z")},m(k,g){ie(k,t,g),c(t,l),c(l,o),c(t,a),c(t,i),c(t,f),_||(v=H(t,"click",E),_=!0)},p(k,g){e=k,g[0]&4&&n!==(n=ce(d[S(e[26],d.length)])+"")&&oe(o,n),g[0]&8&&r!==(r=e[25].name+"")&&oe(i,r),g[0]&26&&u!==(u=_e(e[25]===e[4]&&!e[1]?"selectedTab":"")+" svelte-1b4p12z")&&s(t,"class",u)},d(k){k&&p(t),_=!1,v()}}}function Pn(e){let t,l,n,o,a,r,i,f,u,_,v,E,k,g,b=ce(d[S(e[2],d.length)])+"",I,j,z,J,ne,q,ue,be,ae,fe,A,D,T,R=e[3].label+"",le,ye,Je,Ke,ze,me,ke,Qe,We,Ye,Ie,de,Ze,Te,Ee,he,Ne,xe,et,ge,Le,tt,nt,Me,lt,pe,ot,dt;t=new Sn({props:{rootNoteIndex:e[2],selectedScaleName:e[4].name}});let Se=[...e[4].scale],K=[];for(let h=0;h<Se.length;h+=1)K[h]=Ut(qt(e,Se,h));let Fe=[...d],Q=[];for(let h=0;h<Fe.length;h+=1)Q[h]=jt(Vt(e,Fe,h));let we=ct,W=[];for(let h=0;h<we.length;h+=1)W[h]=Xt(Lt(e,we,h));let Ce=e[3].modes,Y=[];for(let h=0;h<Ce.length;h+=1)Y[h]=$t(Gt(e,Ce,h));let Pe=e[3].modes,Z=[];for(let h=0;h<Pe.length;h+=1)Z[h]=Ht(Ot(e,Pe,h));return de=new Cn({props:{bpm:e[5],rootNoteIndex:e[2],selectedModesGroup:e[3],selectedScaleNotes:e[4].scale}}),{c(){Nt(t.$$.fragment),l=B(),n=N("div"),o=ee("svg"),a=ee("circle");for(let h=0;h<K.length;h+=1)K[h].c();r=Mt();for(let h=0;h<Q.length;h+=1)Q[h].c();i=B(),f=N("div"),u=N("div"),_=C(`Root note
			`),v=N("button"),E=C("-"),k=B(),g=N("span"),I=C(b),j=B(),z=N("button"),J=C("+"),ne=B(),q=N("div"),ue=C(`Mode type
			`);for(let h=0;h<W.length;h+=1)W[h].c();be=B(),ae=N("div"),fe=N("div"),A=N("div"),D=N("h2"),T=C("Equivalent "),le=C(R),ye=C(" modes"),Je=B();for(let h=0;h<Y.length;h+=1)Y[h].c();Ke=B(),ze=N("div"),me=N("div"),ke=N("h2"),Qe=C("Modes by modification"),We=B();for(let h=0;h<Z.length;h+=1)Z[h].c();Ye=B(),Ie=N("div"),Nt(de.$$.fragment),Ze=B(),Te=N("div"),Ee=N("div"),he=N("div"),Ne=N("button"),xe=C("-"),et=B(),ge=N("span"),Le=C(e[5]),tt=C(" bpm"),nt=B(),Me=N("button"),lt=C("+"),this.h()},l(h){St(t.$$.fragment,h),l=O(h),n=M(h,"DIV",{class:!0,"data-sveltekit-preload-data":!0});var F=y(n);o=te(F,"svg",{id:!0,viewBox:!0,xmlns:!0,class:!0});var w=y(o);a=te(w,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0,class:!0}),y(a).forEach(p);for(let L=0;L<K.length;L+=1)K[L].l(w);r=Mt();for(let L=0;L<Q.length;L+=1)Q[L].l(w);w.forEach(p),i=O(F),f=M(F,"DIV",{class:!0});var x=y(f);u=M(x,"DIV",{});var m=y(u);_=P(m,`Root note
			`),v=M(m,"BUTTON",{});var X=y(v);E=P(X,"-"),X.forEach(p),k=O(m),g=M(m,"SPAN",{class:!0});var _t=y(g);I=P(_t,b),_t.forEach(p),j=O(m),z=M(m,"BUTTON",{});var vt=y(z);J=P(vt,"+"),vt.forEach(p),m.forEach(p),ne=O(x),q=M(x,"DIV",{});var at=y(q);ue=P(at,`Mode type
			`);for(let L=0;L<W.length;L+=1)W[L].l(at);at.forEach(p),be=O(x),ae=M(x,"DIV",{});var Ve=y(ae);fe=M(Ve,"DIV",{});var gt=y(fe);A=M(gt,"DIV",{});var qe=y(A);D=M(qe,"H2",{class:!0});var Ue=y(D);T=P(Ue,"Equivalent "),le=P(Ue,R),ye=P(Ue," modes"),Ue.forEach(p),Je=O(qe);for(let L=0;L<Y.length;L+=1)Y[L].l(qe);qe.forEach(p),gt.forEach(p),Ke=O(Ve),ze=M(Ve,"DIV",{});var pt=y(ze);me=M(pt,"DIV",{});var je=y(me);ke=M(je,"H2",{class:!0});var bt=y(ke);Qe=P(bt,"Modes by modification"),bt.forEach(p),We=O(je);for(let L=0;L<Z.length;L+=1)Z[L].l(je);je.forEach(p),pt.forEach(p),Ve.forEach(p),Ye=O(x),Ie=M(x,"DIV",{class:!0});var yt=y(Ie);St(de.$$.fragment,yt),yt.forEach(p),Ze=O(x),Te=M(x,"DIV",{class:!0});var kt=y(Te);Ee=M(kt,"DIV",{class:!0});var It=y(Ee);he=M(It,"DIV",{});var De=y(he);Ne=M(De,"BUTTON",{});var Tt=y(Ne);xe=P(Tt,"-"),Tt.forEach(p),et=O(De),ge=M(De,"SPAN",{class:!0});var rt=y(ge);Le=P(rt,e[5]),tt=P(rt," bpm"),rt.forEach(p),nt=O(De),Me=M(De,"BUTTON",{});var Et=y(Me);lt=P(Et,"+"),Et.forEach(p),De.forEach(p),It.forEach(p),kt.forEach(p),x.forEach(p),F.forEach(p),this.h()},h(){s(a,"cx",e[6].xCentre),s(a,"cy",e[6].yCentre),s(a,"r",e[6].radius),s(a,"stroke","grey"),s(a,"stroke-width",1),s(a,"fill","var(--base-background-color)"),s(a,"class","background svelte-1b4p12z"),s(o,"id","boxOfNotes"),s(o,"viewBox","0 0 800 800"),s(o,"xmlns","http://www.w3.org/2000/svg"),s(o,"class","svelte-1b4p12z"),s(g,"class","noteLabel svelte-1b4p12z"),s(D,"class","svelte-1b4p12z"),s(ke,"class","svelte-1b4p12z"),s(Ie,"class","musicControls svelte-1b4p12z"),s(ge,"class","noteLabel svelte-1b4p12z"),s(Ee,"class","svelte-1b4p12z"),s(Te,"class","musicControls svelte-1b4p12z"),s(f,"class","boxOfButtons svelte-1b4p12z"),s(n,"class","appContainer svelte-1b4p12z"),s(n,"data-sveltekit-preload-data","hover")},m(h,F){Ft(t,h,F),ie(h,l,F),ie(h,n,F),c(n,o),c(o,a);for(let w=0;w<K.length;w+=1)K[w].m(o,null);c(o,r);for(let w=0;w<Q.length;w+=1)Q[w].m(o,null);c(n,i),c(n,f),c(f,u),c(u,_),c(u,v),c(v,E),c(u,k),c(u,g),c(g,I),c(u,j),c(u,z),c(z,J),c(f,ne),c(f,q),c(q,ue);for(let w=0;w<W.length;w+=1)W[w].m(q,null);c(f,be),c(f,ae),c(ae,fe),c(fe,A),c(A,D),c(D,T),c(D,le),c(D,ye),c(A,Je);for(let w=0;w<Y.length;w+=1)Y[w].m(A,null);c(ae,Ke),c(ae,ze),c(ze,me),c(me,ke),c(ke,Qe),c(me,We);for(let w=0;w<Z.length;w+=1)Z[w].m(me,null);c(f,Ye),c(f,Ie),Ft(de,Ie,null),c(f,Ze),c(f,Te),c(Te,Ee),c(Ee,he),c(he,Ne),c(Ne,xe),c(he,et),c(he,ge),c(ge,Le),c(ge,tt),c(he,nt),c(he,Me),c(Me,lt),pe=!0,ot||(dt=[H(v,"click",e[18]),H(z,"click",e[19]),H(Ne,"click",e[23]),H(Me,"click",e[24])],ot=!0)},p(h,F){const w={};if(F[0]&4&&(w.rootNoteIndex=h[2]),F[0]&16&&(w.selectedScaleName=h[4].name),t.$set(w),F[0]&4030){Se=[...h[4].scale];let m;for(m=0;m<Se.length;m+=1){const X=qt(h,Se,m);K[m]?K[m].p(X,F):(K[m]=Ut(X),K[m].c(),K[m].m(o,r))}for(;m<K.length;m+=1)K[m].d(1);K.length=Se.length}if(F[0]&1173){Fe=[...d];let m;for(m=0;m<Fe.length;m+=1){const X=Vt(h,Fe,m);Q[m]?Q[m].p(X,F):(Q[m]=jt(X),Q[m].c(),Q[m].m(o,null))}for(;m<Q.length;m+=1)Q[m].d(1);Q.length=Fe.length}if((!pe||F[0]&4)&&b!==(b=ce(d[S(h[2],d.length)])+"")&&oe(I,b),F[0]&24){we=ct;let m;for(m=0;m<we.length;m+=1){const X=Lt(h,we,m);W[m]?W[m].p(X,F):(W[m]=Xt(X),W[m].c(),W[m].m(q,null))}for(;m<W.length;m+=1)W[m].d(1);W.length=we.length}if((!pe||F[0]&8)&&R!==(R=h[3].label+"")&&oe(le,R),F[0]&30){Ce=h[3].modes;let m;for(m=0;m<Ce.length;m+=1){const X=Gt(h,Ce,m);Y[m]?Y[m].p(X,F):(Y[m]=$t(X),Y[m].c(),Y[m].m(A,null))}for(;m<Y.length;m+=1)Y[m].d(1);Y.length=Ce.length}if(F[0]&30){Pe=h[3].modes;let m;for(m=0;m<Pe.length;m+=1){const X=Ot(h,Pe,m);Z[m]?Z[m].p(X,F):(Z[m]=Ht(X),Z[m].c(),Z[m].m(me,null))}for(;m<Z.length;m+=1)Z[m].d(1);Z.length=Pe.length}const x={};F[0]&32&&(x.bpm=h[5]),F[0]&4&&(x.rootNoteIndex=h[2]),F[0]&8&&(x.selectedModesGroup=h[3]),F[0]&16&&(x.selectedScaleNotes=h[4].scale),de.$set(x),(!pe||F[0]&32)&&oe(Le,h[5])},i(h){pe||(wt(t.$$.fragment,h),wt(de.$$.fragment,h),pe=!0)},o(h){Ct(t.$$.fragment,h),Ct(de.$$.fragment,h),pe=!1},d(h){Pt(t,h),h&&p(l),h&&p(n),Be(K,h),Be(Q,h),Be(W,h),Be(Y,h),Be(Z,h),Pt(de),ot=!1,He(dt)}}}function Dn(e,t,l){const n={xCentre:400,yCentre:400,radius:300};let o={};ut.subscribe(T=>{l(0,o=T)});let a=!0;const r={...n,radius:n.radius},i={...n,radius:n.radius-70},f={...n,radius:n.radius+70};let u=0,_=ct[0],v=_.modes[0];const E=(T,R)=>({x:R.xCentre+R.radius*Math.cos(T*2*Math.PI/d.length-.5*Math.PI),y:R.yCentre+R.radius*Math.sin(T*2*Math.PI/d.length-.5*Math.PI)}),k=(T,R,le)=>({x:le.xCentre+le.radius*Math.cos((T.semitonesFromRoot+R)*2*Math.PI/d.length-.5*Math.PI),y:le.yCentre+le.radius*Math.sin((T.semitonesFromRoot+R)*2*Math.PI/d.length-.5*Math.PI)});let g=70;return[o,a,u,_,v,g,n,r,i,f,E,k,T=>At(u,T,v.scale,60*1e3/g),(T,R)=>R.key==="Enter"&&At(u,T,v.scale,60*1e3/g),T=>zt(T,u,60*1e3/g),(T,R)=>R.key==="Enter"&&zt(T,u,60*1e3/g),T=>G(d[u],S(T-u,d.length),0,500),(T,R)=>R.key==="Enter"&&G(d[u],S(T-u,d.length),0,500),()=>{l(2,u=u-1),u<0&&l(2,u=u+12)},()=>{l(2,u=u+1),u>=12&&l(2,u=u-12)},T=>{_!==T&&(l(3,_=T),l(4,v=T.modes[0]))},(T,R)=>{l(4,v=T),l(2,u=S(R,d.length)),l(1,a=!0)},(T,R)=>{l(4,v=T),l(2,u=S(R,d.length)),l(1,a=!1)},()=>{g>10&&l(5,g=g-20)},()=>{l(5,g=g+20)}]}class zn extends ht{constructor(t){super(),ft(this,t,Dn,Pn,mt,{},null,[-1,-1])}}export{zn as default};
